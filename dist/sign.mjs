async function M(n,t){if(!(n instanceof Uint8Array)&&!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array input data.");if(typeof window>"u"&&typeof Deno>"u"){let{createHmac:e}=await import("crypto");return Uint8Array.from([...e("SHA256",t).update(n).digest()])}else return window.crypto.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign","verify"]).then(e=>window.crypto.subtle.sign("HMAC",e,n)).then(e=>new Uint8Array(e))}var f=M;async function N(n){if(!(n instanceof Uint8Array))throw new TypeError("Expected Uint8Array input data.");if(typeof window>"u"){let{createHash:t}=await import("crypto");return new Uint8Array(t("sha256").update(n).digest())}else return new Uint8Array(await crypto.subtle.digest("SHA-256",n))}var S=N;var v=n=>{let t=n.toString(16);return t=t.length%2?t.padStart(t.length+1,"0"):t,Uint8Array.from(t.match(/[a-f0-9A-F]{2}/gmu).map(e=>+`0x${e}`))},w=n=>BigInt(`0x${n.reduce((t,e)=>t+=e.toString(16).padStart(2,"0"),"")}`);var $=Object.freeze({x:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,y:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,mod:115792089237316195423570985008687907853269984665640564039457584007908834671663n,n:115792089237316195423570985008687907852837564279074904382605163141518161494337n,a:0x0000000000000000000000000000000000000000000000000000000000000000n,b:0x0000000000000000000000000000000000000000000000000000000000000007n,h:1n});var s=(n,t)=>(n%t+t)%t;function B(n,t){let e,r,a,o=t,c=s(n,t),y=t,u=0n,i=1n;if(t==1n)e=1n;else for(;c>1n;)a=c/o,r=o,e=c%o,o=e,c=r,r=u,a=u*a,u=i-a,i=r;return i<0n&&(i=i+y),e=i,e}var C=(n,t,e,r)=>{let a=s(s(e*e,r)-t.x-n.x,r),o=s(s((t.x-a)*e,r)-t.y,r);return{x:a,y:o}},j=(n,t,e)=>{let r=B(t.x-n.x,e),a=s(s(t.y-n.y,e)*r,e);return C(n,t,a,e)},q=(n,t)=>{let e=s(s(n.x*n.x,t)*3n,t),r=s(B(2n*n.y,t)*e,t);return C(n,n,r,t)},E=(n,t,e,r)=>(t=s(t,r),t==1n?n:t%2n?j(E(n,t-1n,e,r),n,e):E(q(n,e),t/2n,e,r));var h=async(n,t,e,r,a=0,o=$)=>{let{x:c,y,mod:u,n:i}=o,m={x:c,y},b,x,A=async({buf_h2b:_,buf_F:g})=>{let H=Uint8Array.from([..._,0]),I=await f(H,g),D=await f(_,I),F=await f(D,I);return w(F)};if(n-i>=0n||0n>=n)return h(await A(r),t,e,r);let l=n,p=E(m,l,u,i);if(p.x==0n&&p.y==0n)return h(await A(r),t,e,r);let d=0n;return b=v(p.x),l=s(B(n,i)*(p.x*e+t),i),p.y%2n?a=1n|d:a=0n|d,l>i/2n&&(l=i-l,a=a^1n),x=v(l),{r:b,s:x,racid:a}};async function z({private_key:n,data:t}){let e=await S(t),r=async(a,o,c=0)=>{let y=c?await S(Uint8Array.from([...a,...new Uint8Array(c)])):a,u=new Uint8Array(32).fill(1),i=new Uint8Array(32).fill(0),m=await f(Uint8Array.from([...u,0,...o,...y]),i),b=await f(u,m),x=await f(Uint8Array.from([...b,1,...o,...y]),m),A=await f(b,x),U=await f(A,x),l=w(U),p=w(a),d=w(o),{r:_,s:g,racid:H}=await h(l,p,d,{buf_h2b:U,buf_F:x});return _[0]>=0x80n||g[0]>=0x80n?r(a,o,++c):{r:_,s:g,v:Number(H)}};return r(e,n)}var Z=z;export{Z as default};
