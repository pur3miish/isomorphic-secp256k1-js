async function H(e){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array input data.");if(typeof window>"u"){let{createHash:t}=await import("crypto");return new Uint8Array(t("sha256").update(e).digest())}else return new Uint8Array(await crypto.subtle.digest("SHA-256",e))}var w=H;var m=e=>{let t=e.toString(16);return t=t.length%2?t.padStart(t.length+1,"0"):t,Uint8Array.from(t.match(/[a-f0-9A-F]{2}/gmu).map(n=>+`0x${n}`))},u=e=>BigInt(`0x${e.reduce((t,n)=>t+=n.toString(16).padStart(2,"0"),"")}`);var y=Object.freeze({x:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,y:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,mod:115792089237316195423570985008687907853269984665640564039457584007908834671663n,n:115792089237316195423570985008687907852837564279074904382605163141518161494337n,a:0x0000000000000000000000000000000000000000000000000000000000000000n,b:0x0000000000000000000000000000000000000000000000000000000000000007n,h:1n}),$=(e,t,n)=>{let r=1n,o=e%n,a=t;if(o==0n)return 0n;for(;a>0n;)a%2n&&(r=r*o%n),a=a>>1n,o=o**2n%n;return r},c=(e,t)=>(e%t+t)%t;function f(e,t){let n,r,o,a=t,s=c(e,t),x=t,p=0n,i=1n;if(t==1n)n=1n;else for(;s>1n;)o=s/a,r=a,n=s%a,a=n,s=r,r=p,o=p*o,p=i-o,i=r;return i<0n&&(i=i+x),n=i,n}var d=(e,t,n,r)=>{let o=c(c(n*n,r)-t.x-e.x,r),a=c(c((t.x-o)*n,r)-t.y,r);return{x:o,y:a}},_=(e,t,n)=>{let r=f(t.x-e.x,n),o=c(c(t.y-e.y,n)*r,n);return d(e,t,o,n)},j=(e,t)=>{let n=c(c(e.x*e.x,t)*3n,t),r=c(f(2n*e.y,t)*n,t);return d(e,e,r,t)},l=(e,t,n,r)=>(t=c(t,r),t==1n?e:t%2n?_(l(e,t-1n,n,r),e,n):l(j(e,n),t/2n,n,r)),g=(e,t)=>{let{mod:n,b:r}=y;e=BigInt(e);let o=c(BigInt(t)**3n+r,n),a=$(o,n/4n+1n,n);return!(a%2n)^!e&&(a=n-a),{x:t,y:a}};async function q({data:e,signature:t}){let{n,mod:r,x:o,y:a}=y,{s,r:x,v:p}=t,i=BigInt(p);if(i>3n)throw new Error("Invalid value for v.");let h=i>>1n?u(x)+n:u(x),v=g(i&3n,h),A=u(await w(e)),U=c(A*-1n,n),I=f(u(x),n),S=l(v,u(s),r,n),B=l({x:o,y:a},U,r,n),E=_(S,B,r),b=l(E,I,r,n);return Uint8Array.from([b.y%2n?3:2,...m(b.x)])}var D=q;export{D as default};
